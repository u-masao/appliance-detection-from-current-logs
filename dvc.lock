schema: '2.0'
stages:
  convert_xml_to_parquet@env_temp:
    cmd: python -m src.data.convert_from_xml_to_parquet data/raw/env_temp.xml data/interim/env_temp.parquet
    deps:
    - path: data/raw/env_temp.xml
      hash: md5
      md5: d3c1ac14db8e84891f0a61c29c643190
      size: 72520793
    - path: src/data/convert_from_xml_to_parquet.py
      hash: md5
      md5: 88da0f001cf3fb2022198d2950a6d0b7
      size: 3876
    outs:
    - path: data/interim/env_temp.parquet
      hash: md5
      md5: 972a592a61627c5dcf256d340c33c62f
      size: 3221030
  convert_xml_to_parquet@star_watt:
    cmd: python -m src.data.convert_from_xml_to_parquet data/raw/star_watt.xml data/interim/star_watt.parquet
    deps:
    - path: data/raw/star_watt.xml
      hash: md5
      md5: 3e48c4b58b5edc3c96417d6b3a3c876f
      size: 649685660
    - path: src/data/convert_from_xml_to_parquet.py
      hash: md5
      md5: 88da0f001cf3fb2022198d2950a6d0b7
      size: 3876
    outs:
    - path: data/interim/star_watt.parquet
      hash: md5
      md5: 26c3f17d550c58ce045d9de9b83f70ff
      size: 38166479
  merge_parquet_files:
    cmd: python src/data/merge_parquet_files.py data/interim/env_temp.parquet data/interim/star_watt.parquet
      data/interim/dataset.parquet
    deps:
    - path: data/interim/env_temp.parquet
      hash: md5
      md5: 972a592a61627c5dcf256d340c33c62f
      size: 3221030
    - path: data/interim/star_watt.parquet
      hash: md5
      md5: 26c3f17d550c58ce045d9de9b83f70ff
      size: 38166479
    - path: src/data/merge_parquet_files.py
      hash: md5
      md5: fe6bda10f7206e708b7ad6bc111a1126
      size: 4906
    outs:
    - path: data/interim/dataset.parquet
      hash: md5
      md5: 794d570f00a5b78c66a1f0b1257e6223
      size: 39634109
  build_features:
    cmd: python src/features/build_features.py data/interim/dataset.parquet data/interim/features.parquet
    deps:
    - path: data/interim/dataset.parquet
      hash: md5
      md5: 794d570f00a5b78c66a1f0b1257e6223
      size: 39634109
    - path: src/features/build_features.py
      hash: md5
      md5: 9d8c7b2328cca512768820830dbbcaa7
      size: 2721
    outs:
    - path: data/interim/features.parquet
      hash: md5
      md5: 892b254eae278e9458da1bd156b1c41f
      size: 62374638
  train_model:
    cmd: python src/models/train_transformer.py data/interim/features.parquet models/best_model.pth
      --data_fraction 0.01 --n_trials 5 --num_epochs 3 --input_length 180 --batch_size
      4096 --train_ratio 0.7 --val_ratio 0.15
    deps:
    - path: data/interim/features.parquet
      hash: md5
      md5: 892b254eae278e9458da1bd156b1c41f
      size: 62374638
    - path: src/models/train_transformer.py
      hash: md5
      md5: ceea11188cf77e063380bf7b683e19b0
      size: 10180
    outs:
    - path: models/best_model.pth
      hash: md5
      md5: eec23f98f09575df838680b10a7a2ae1
      size: 6806678
